{% extends "base.html" %}

{% block title %}Моите обяви{% endblock %}

{% block content %}
<div class="container py-5">
    <div class="d-flex justify-content-between align-items-end mb-5">
        <div>
            <h2 class="fw-bold text-white mb-1">Моите <span class="text-success">Обяви</span></h2>
            <p class="text-white-50 m-0">Управлявайте вашите активни предложения</p>
        </div>
        <div class="text-end">
            <a href="{{ url_for('routes.add_car') }}" class="btn btn-success rounded-pill fw-bold px-4 shadow-lg">
                <i class="bi bi-plus-lg me-2"></i>Нова обява
            </a>
        </div>
    </div>

    {% if cars %}
    <div class="row g-4">
        {% for car in cars %}
        <div class="col-12">
            <div class="card bg-dark border-secondary border-opacity-25 rounded-4 overflow-hidden shadow-lg hover-row">
                <div class="row g-0">
                    <div class="col-md-3">
                        <div class="ratio ratio-4x3 h-100">
                            {% if car.images %}
                                {% set main_img = car.images|selectattr("is_main")|first or car.images[0] %}
                                <img src="{{ url_for('static', filename='uploads/cars/' + main_img.filename) }}" class="object-fit-cover" alt="{{ car.brand }}">
                            {% else %}
                                <div class="bg-dark d-flex align-items-center justify-content-center">
                                    <i class="bi bi-camera text-secondary fs-1"></i>
                                </div>
                            {% endif %}
                        </div>
                    </div>
                    
                    <div class="col-md-6 p-4">
                        <div class="d-flex flex-column h-100">
                            <div>
                                <h4 class="text-white fw-bold mb-1">{{ car.brand }} {{ car.model }}</h4>
                                <div class="text-success fs-3 fw-bold mb-3">{{ "{:,.0f}".format(car.price) | replace(",", " ") }} лв.</div>
                            </div>
                            
                            <div class="row g-2 text-white-50 small mb-auto">
                                <div class="col-6"><i class="bi bi-calendar3 text-success me-2"></i>{{ car.year }} г.</div>
                                <div class="col-6"><i class="bi bi-speedometer2 text-success me-2"></i>{{ "{:,.0f}".format(car.mileage) | replace(",", " ") }} км</div>
                                <div class="col-6"><i class="bi bi-geo-alt text-success me-2"></i>{{ car.location }}</div>
                                <div class="col-6"><i class="bi bi-fuel-pump text-success me-2"></i>{{ car.fuel }}</div>
                            </div>

                            <div class="mt-3">
                                <span class="badge bg-success bg-opacity-10 text-success border border-success border-opacity-25 px-3 py-2 rounded-pill">
                                    Активна обява
                                </span>
                            </div>
                        </div>
                    </div>

                    <div class="col-md-3 p-4 border-start border-secondary border-opacity-25 bg-black bg-opacity-20">
                        <div class="d-flex flex-md-column justify-content-center gap-2 h-100">
                            <a href="{{ url_for('routes.car_detail', id=car.id) }}" class="btn btn-outline-light rounded-pill w-100 fw-bold py-2">
                                <i class="bi bi-eye me-2"></i>Преглед
                            </a>
                            <a href="#" class="btn btn-outline-secondary rounded-pill w-100 fw-bold py-2">
                                <i class="bi bi-pencil me-2"></i>Редактирай
                            </a>
                            <button class="btn btn-outline-danger rounded-pill w-100 fw-bold py-2">
                                <i class="bi bi-trash3 me-2"></i>Изтрий
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
    {% else %}
    <div class="text-center py-5 px-4 rounded-5 border border-secondary border-opacity-25 bg-dark bg-opacity-50 shadow-lg">
        <div class="mb-4">
            <div class="bg-dark d-inline-flex align-items-center justify-content-center rounded-circle border border-secondary border-opacity-50" style="width: 120px; height: 120px;">
                <i class="bi bi-car-front text-success" style="font-size: 3.5rem;"></i>
            </div>
        </div>
        <h2 class="text-white fw-bold">Все още нямате обяви</h2>
        <p class="text-white-50 mb-5 mx-auto" style="max-width: 500px;">
            Продайте своя автомобил бързо и лесно. Хиляди потенциални купувачи ви очакват в CarMarket.
        </p>
        <a href="{{ url_for('routes.add_car') }}" class="btn btn-success btn-lg rounded-pill px-5 fw-bold shadow-lg text-dark">
            Публикувай първата си обява
        </a>
    </div>
    {% endif %}
</div>

<style>
    .hover-row {
        transition: transform 0.3s ease, border-color 0.3s ease;
    }
    .hover-row:hover {
        transform: scale(1.01);
        border-color: rgba(0, 255, 133, 0.4) !important;
    }
    .badge {
        font-size: 0.75rem;
        letter-spacing: 0.5px;
        text-transform: uppercase;
    }
    .object-fit-cover {
        object-fit: cover;
    }
</style>
{% endblock %}